import{Signal as n,signal as r,computed as t,effect as e}from"@preact/signals-core";import i,{version as u,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED as o,useRef as f,useLayoutEffect as c,useMemo as a,useEffect as s}from"react";import{useSyncExternalStore as l}from"use-sync-external-store/shim/index.js";import v from"react/jsx-runtime";import m from"react/jsx-dev-runtime";var p=!1,d=null,b=!1,g=null,h=new Map;function y(n){if(!n)return 1;var r,t=h.get(n);if(void 0!==t)return t;var e=n.useCallback.toString();if(n.useReducer===n.useEffect)r=1;else if(n.useEffect===n.useImperativeHandle)r=32;else if(/Invalid/.test(e))r=2;else if(/updateCallback/.test(e)||/\[0\]/.test(e)&&/\[1\]/.test(e)){var i=n.useReducer.toString();if(/rerenderReducer/.test(i)||/return\s*\[\w+,/.test(i))r=16;else r=8}else r=4;h.set(n,r);return r}function _(){if(u.split(".").map(Number)[0]>=19)throw new Error("Automatic signals tracking is not supported in React 19 and later, try the Babel plugin instead https://github.com/preactjs/signals/tree/main/packages/react-transform#signals-react-transform.");!function(){p=!0;Object.defineProperty(o.ReactCurrentDispatcher,"current",{get:function(){return g},set:function(n){if(!b){var r=y(g),t=y(n);g=n;if(function(n,r){if(1&n&&28&r)return!0;else if(2&n||2&r)return!1;else return!1}(r,t)){b=!0;d=M(1);b=!1}else if(function(n,r){return Boolean(28&n&&16&r)}(r,t)){var e;null==(e=d)||e.f();b=!0;d=M(1);b=!1}else if(function(n,r){return Boolean(28&n&&1&r)}(r,t)){var i;null==(i=d)||i.f();d=null}}else g=n}})}();!function(){var n=v,r=m;i.createElement=k(i.createElement);r.jsx&&(r.jsx=k(r.jsx));n.jsx&&(n.jsx=k(n.jsx));r.jsxs&&(r.jsxs=k(r.jsxs));n.jsxs&&(n.jsxs=k(n.jsxs));r.jsxDEV&&(r.jsxDEV=k(r.jsxDEV));n.jsxDEV&&(n.jsxDEV=k(n.jsxDEV))}()}var j=[],S=Symbol.for("react.element"),x=function(){};function k(r){if("function"!=typeof r)return r;else return function(t,e){if("string"==typeof t&&e)for(var i in e){var u=e[i];if("children"!==i&&u instanceof n)e[i]=u.value}return r.call.apply(r,[r,t,e].concat([].slice.call(arguments,2)))}}var w,B=Symbol.dispose||Symbol.for("Symbol.dispose");function O(n,r){var t=r.effect.S();w=r;return P.bind(r,n,t)}function P(n,r){r();w=n}var R,$,A=((R={u:0,effect:{s:void 0,c:function(){},S:function(){return x},d:function(){}},subscribe:function(){return x},getSnapshot:function(){return 0},S:function(){},f:function(){}})[B]=function(){},R),C=Promise.prototype.then.bind(Promise.resolve());function E(){if(!$)$=C(I)}function I(){var n;$=void 0;null==(n=w)||n.f()}function M(n){if(void 0===n)n=0;E();var r=f();if(null==r.current)r.current=function(n){var r,t,i,u,o=0,f=e(function(){t=this});t.c=function(){o=o+1|0;if(u)u()};return(r={u:n,effect:t,subscribe:function(n){u=n;return function(){o=o+1|0;u=void 0;f()}},getSnapshot:function(){return o},S:function(){if(null!=w){var n=w.u,r=this.u;if(0==n&&0==r||0==n&&1==r){w.f();i=O(void 0,this)}else if(1==n&&0==r||2==n&&0==r);else i=O(w,this)}else i=O(void 0,this)},f:function(){var n=i;i=void 0;null==n||n()}})[B]=function(){this.f()},r}(n);var t=r.current;l(t.subscribe,t.getSnapshot,t.getSnapshot);t.S();if(0===n)c(I);return t}Object.defineProperties(n.prototype,{$$typeof:{configurable:!0,value:S},type:{configurable:!0,value:function(n){var r=n.data,t=M(1);try{return r.value}finally{t.f()}}},props:{configurable:!0,get:function(){return{data:this}}},ref:{configurable:!0,value:null}});function N(n){if(p)return A;else return M(n)}function useSignal(n){return a(function(){return r(n)},j)}function useComputed(n){var r=f(n);r.current=n;return a(function(){return t(function(){return r.current()})},j)}function useSignalEffect(n){var r=f(n);r.current=n;s(function(){return e(function(){return r.current()})},j)}export{M as _useSignalsImplementation,E as ensureFinalCleanup,_ as installAutoSignalTracking,useComputed,useSignal,useSignalEffect,N as useSignals,k as wrapJsx};//# sourceMappingURL=runtime.module.js.map
